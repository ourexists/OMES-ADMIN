<!--
  ~ Copyright (c) 2025. created by ourexists.https://gitee.com/ourexists
  -->
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../static/layui/css/layui.css">
    <script src="../static/js/jquery.min.js"></script>
    <script src="../static/layui/layui.js"></script>
    <script src="../static/js/i18n.js"></script>
    <script src="../static/js/global.js"></script>
</head>
<body>
<div class="layui-tab-content" style="padding: 15px;">
    <table class="layui-hide" id="tb-common"></table>
</div>
<script type="text/html" id="tb-common-toolbar">
    <div class="layui-btn-container">
        <button class="layui-btn layui-btn-sm layui-btn-primary" id="rowMode">
            <span>{{= d.lineStyle ? i18np.prop('common.mode.multi') : i18np.prop('common.mode.single') }}</span>
            <i class="layui-icon layui-icon-down layui-font-12"></i>
        </button>
    </div>
</script>

<script th:inline="none">
    var table;
    var tbData;
    layui.use(['form', 'table', 'dropdown', 'layer'], function () {
        table = layui.table;
        var dropdown = layui.dropdown;

        let no = layui.url().search.id;


        // 创建表格实例
        table.render({
            elem: '#tb-common',
            id: 'tb-common',
            headers: getCommonHeader(),
            method: 'POST',
            toolbar: '#tb-common-toolbar',
            defaultToolbar: ['filter', 'exports', 'print'],
            cols: [[
                {field: 'LAY_INDEX', title: 'NO'},
                {field: 'tank', title: i18np.prop('fzdata.tank')},
                {field: 'lm', title: i18np.prop('fzdata.lm')},
                {field: 'll', title: i18np.prop('fzdata.ll')},
                {field: 'sj', title: i18np.prop('fzdata.sj')},
                {field: 'wc', title: i18np.prop('fzdata.wc')},
            ]],
            page: false,
            height: 'full'
        });
        let params = {
            "fzId": no,
            "requirePage": false
        }
        post(router.imrecord_page, params, function (result) {
            tbData = result == null ? [] : result;
            reloadTb();
        })

        // table 滚动时移除内部弹出的元素
        var tableInst = table.getOptions('tb-common');
        tableInst.elem.next().find('.layui-table-main').on('scroll', function () {
            dropdown.close('dropdown-table-tool');
        });
    });

    function reloadTb() {
        table.reloadData('tb-common', {
            data: tbData
        });
    }


</script>
</body>
</html>