<!--
  ~ Copyright (c) 2025. created by ourexists.https://gitee.com/ourexists
  -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../static/layui/css/layui.css">
    <script src="../static/js/jquery.min.js"></script>
    <script src="../static/layui/layui.js"></script>
    <script src="../static/js/i18n.js"></script>
    <script src="../static/js/global.js"></script>
</head>
<body>
<div style="padding: 16px;">
    <form class="layui-form layui-form-pane" action="" id="common-edit-form" lay-filter="common-edit-form">
        <div class="layui-form-item">
            <label class="layui-form-label" lang-i18n="manual.pass"></label>
            <div class="layui-input-block">
                <input type="text" name="pass" autocomplete="off" lay-verify="required" class="layui-input"
                       onclick="input_limit_float(this)">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" lang-i18n="manual.result"></label>
            <div class="layui-input-block">
                <select name="result" id="result">
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" lang-i18n="manual.desc"></label>
            <div class="layui-input-block">
                <textarea name="msg" class="layui-textarea"></textarea>
            </div>
        </div>
        <div class="layui-form-item">
            <button class="layui-btn" lay-submit lay-filter="common-edit-button" lang-i18n="common.msg.confirm">确认
            </button>
            <button type="reset" class="layui-btn layui-btn-primary" lang-i18n="common.msg.reset">重置</button>
        </div>
    </form>
</div>
<script>
    var current_row_data = {};
    layui.use(['form', 'layer'], function () {
        var form = layui.form,
            layer = layui.layer;

        let id = layui.url().search.id;
        current_row_data.id = id;

        form.val("common-edit-form", {
            "pass": "0",
            "result": "",
            "msg": ""
        });
        get(router.qa_status, null, function (result) {
            $.each(result, function (index, item) {
                    if (item.id !== '0') {
                        //option  第一个参数是页面显示的值，第二个参数是传递到后台的值
                        $('#result').append(new Option(item.name, item.id));//往下拉菜单里添加元素
                    }
                    form.render();
                }
            )
        })

        // 提交事件
        form.on('submit(common-edit-button)', function (data) {
            var field = data.field; // 获取表单字段值
            current_row_data.pass = field.pass;
            current_row_data.result = field.result;
            current_row_data.msg = field.msg;

            post(router.qa_check, current_row_data, function () {
                var index = parent.layer.getFrameIndex(window.name);
                parent.layer.close(index);
                parent.reloadTb();
            }, function (code, msg) {
                layer.alert(msg, {
                    title: 'error'
                });
            })
            return false;
        });
    });
</script>
</body>
</html>